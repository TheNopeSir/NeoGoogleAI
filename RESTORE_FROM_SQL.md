# üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ SQL –¥–∞–º–ø–∞

## –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ SQL —Ñ–∞–π–ª–∞

–ó–∞–≥—Ä—É–∑–∏—Ç–µ –≤–∞—à SQL –¥–∞–º–ø –≤ –ø—Ä–æ–µ–∫—Ç:

```bash
# –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ SCP
scp /path/to/backup.sql user@server:/home/user/NeoGoogleAI/

# –°–ø–æ—Å–æ–± 2: –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –≤—Ä—É—á–Ω—É—é
nano backup.sql
# –í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ SQL –¥–∞–º–ø–∞
# Ctrl+X, Y, Enter –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

# –°–ø–æ—Å–æ–± 3: –°–∫–∞—á–∞—Ç—å —Å —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
wget https://your-server.com/path/to/backup.sql
# –∏–ª–∏
curl -O https://your-server.com/path/to/backup.sql
```

## –®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å JSON –±—ç–∫–∞–ø –∏–∑ —Ç–µ–∫—É—â–µ–π –ë–î

**–í–ê–ñ–ù–û:** –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ JSON –±—ç–∫–∞–ø —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ë–î –Ω–∞ —Å–ª—É—á–∞–π, –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ–π–¥–µ—Ç –Ω–µ —Ç–∞–∫:

```bash
# –°–æ–∑–¥–∞–µ–º –±—ç–∫–∞–ø —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
node backupDatabase.js
# –≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª: backup_exhibits_<timestamp>.json
```

## –®–∞–≥ 3: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ SQL –¥–∞–º–ø–∞

### –í–∞—Ä–∏–∞–Ω—Ç A: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã exhibits

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –ë–î –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏–∑ –¥–∞–º–ø–∞
PGPASSWORD='9H@DDCb.gQm.S}' psql -h 185.152.92.64 -U gen_user -d default_db < backup.sql

# 2. –ò–ª–∏ —Ç–æ–ª—å–∫–æ —Ç–∞–±–ª–∏—Ü—É exhibits
PGPASSWORD='9H@DDCb.gQm.S}' psql -h 185.152.92.64 -U gen_user -d default_db << 'EOF'
-- –ï—Å–ª–∏ –Ω—É–∂–Ω–æ, –æ—á–∏—Å—Ç–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É
TRUNCATE TABLE exhibits;
-- –ó–∞—Ç–µ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ
\i backup.sql
EOF
```

### –í–∞—Ä–∏–∞–Ω—Ç B: –ß–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç (–±–µ–∑–æ–ø–∞—Å–Ω–µ–µ)

```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞
node importFromSQL.js backup.sql

# –û–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
# 1. –°–æ–∑–¥–∞—Å—Ç —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é —Ç–µ–∫—É—â–µ–π –ë–î
# 2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ SQL
# 3. –ü–æ–∫–∞–∂–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
```

## –®–∞–≥ 4: –°–æ–∑–¥–∞—Ç—å JSON –±—ç–∫–∞–ø –∏–∑ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –ë–î

```bash
# –ü–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è SQL —Å–æ–∑–¥–∞–π—Ç–µ JSON –±—ç–∫–∞–ø
node backupDatabase.js

# –≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç —Ñ–∞–π–ª: backup_exhibits_<timestamp>.json
# –í –Ω–µ–º –±—É–¥—É—Ç –≤—Å–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –∏–∑ SQL –¥–∞–º–ø–∞
```

## –®–∞–≥ 5: –ú–∏–≥—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π base64 ‚Üí WebP

```bash
# 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤ –ë–î –µ—Å—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
node diagnoseImages.js

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é
node migrateImages.js --execute

# –≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ WebP —Ñ–∞–π–ª—ã –¥–ª—è –≤—Å–µ—Ö base64 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```

## –®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–∏
node diagnoseImages.js

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
# ‚úÖ –û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ (WebP): XX –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
# ‚ùå –ë–∏—Ç—ã–µ –ø—É—Ç–∏ (404): 0
```

## üîß –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥: –ü—Ä—è–º–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤

–ï—Å–ª–∏ SQL –¥–∞–º–ø —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ (INSERT statements):

```bash
# 1. –ò–∑–≤–ª–µ—á—å –¥–∞–Ω–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –≤ JSON
node extractExhibitsFromSQL.js backup.sql > extracted_backup.json

# 2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ JSON
node restoreFromBackup.js extracted_backup.json --execute

# 3. –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
node migrateImages.js --execute
```

## üìä –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:
- ‚úÖ –í—Å–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- ‚úÖ Base64 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ WebP
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã 4 —Ä–∞–∑–º–µ—Ä–∞: thumbnail (240x240), medium (800x800), large (1200x1200), placeholder (20x20)
- ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è**: –í—Å–µ–≥–¥–∞ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ JSON –±—ç–∫–∞–ø –ü–ï–†–ï–î –∏–º–ø–æ—Ä—Ç–æ–º SQL
2. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –ë–î –¥–æ—Å—Ç—É–ø–Ω–∞ (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ —á–µ—Ä–µ–∑ `node diagnoseImages.js`)
3. **–†–∞–∑–º–µ—Ä**: –ú–∏–≥—Ä–∞—Ü–∏—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –≤—Ä–µ–º—è
4. **–ú–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –µ—Å—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Å—Ç–∞ –≤ `uploads/images/`

## üÜò Troubleshooting

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ .env
cat .env

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ë–î
PGPASSWORD='9H@DDCb.gQm.S}' psql -h 185.152.92.64 -U gen_user -d default_db -c "SELECT COUNT(*) FROM exhibits;"
```

### SQL –¥–∞–º–ø –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞
head -20 backup.sql

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä
ls -lh backup.sql
```

### –ü–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤ SQL –¥–∞–º–ø–µ –µ—Å—Ç—å imageUrls
grep -i "imageUrls" backup.sql | head -5

# –ò–ª–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —á–µ—Ä–µ–∑ –ë–î
PGPASSWORD='9H@DDCb.gQm.S}' psql -h 185.152.92.64 -U gen_user -d default_db -c "SELECT data->'imageUrls' FROM exhibits LIMIT 1;"
```
