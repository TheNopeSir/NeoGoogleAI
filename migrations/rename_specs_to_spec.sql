-- ==========================================
-- üîß –ú–ò–ì–†–ê–¶–ò–Ø: –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ specs ‚Üí spec
-- ==========================================
-- –≠—Ç–∞ –º–∏–≥—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç –ø–æ–ª–µ "specs" –≤ "spec" –¥–ª—è –≤—Å–µ—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
-- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞ —Å—Ç–∞—Ä–æ–≥–æ –¥–∞–º–ø–∞, –≥–¥–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ
-- ==========================================

-- –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–∫–æ–ª—å–∫–æ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –∏–º–µ—é—Ç –ø–æ–ª–µ specs
SELECT COUNT(*) as exhibits_with_specs
FROM exhibits
WHERE data ? 'specs';

-- –í—ã–ø–æ–ª–Ω—è–µ–º –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
UPDATE exhibits
SET data = data - 'specs' || jsonb_build_object('spec', data->'specs')
WHERE data ? 'specs';

-- –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
SELECT
    COUNT(*) as total_exhibits,
    COUNT(CASE WHEN data ? 'spec' THEN 1 END) as with_spec,
    COUNT(CASE WHEN data ? 'specs' THEN 1 END) as with_specs
FROM exhibits;

SELECT '–ú–∏–≥—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –ü–æ–ª–µ specs –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ –≤ spec' as status;
